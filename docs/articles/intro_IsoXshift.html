<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Isobolic Interaction Identification and Estimation using Data-Adaptive Stochastic Interventions • IsoXshift</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Isobolic Interaction Identification and Estimation using Data-Adaptive Stochastic Interventions">
<meta property="og:description" content="IsoXshift">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IsoXshift</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro_IsoXshift.html">Isobolic Interaction Identification and Estimation using Data-Adaptive Stochastic Interventions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro_IsoXshift_files/kePrint-0.0.1/kePrint.js"></script><link href="intro_IsoXshift_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Isobolic Interaction Identification and
Estimation using Data-Adaptive Stochastic Interventions</h1>
                        <h4 data-toc-skip class="author">David
McCoy</h4>
            
            <h4 data-toc-skip class="date">2024-04-04</h4>
      
      
      <div class="hidden name"><code>intro_IsoXshift.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">IsoXshift</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: usethis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'kableExtra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     group_rows</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/sl3" class="external-link">sl3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">429153</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>The motivation behind the package IsoXshift is to simulate isobolic
interaction definitions used in toxicology. In areas of climate change
or pollutant control, we are interested in identifying the most
efficient set of interventions that lead to a target outcome level and
we also want to know what the expected outcome would be if we tried to
implement such a targeted intervention on a population understanding
that it’s not realistically to give all individuals the exact exposure
levels due to different likelihoods of exposure. This package identifies
the exposure levels for two exposures that, if set, result in the target
outcome with minimum change from the original exposure distribution.
Then it estimates the expected outcome if we were to try and get the
population as close as possible to this optimal intervention strategy.
This package analysis mixed exposures, finding the exposure relationship
with the strongest synergist or antagonistic relationship and estimates
a policy that tries to change people’s exposures to these target
levels.</p>
</div>
<div class="section level2">
<h2 id="target-parameter">Target Parameter<a class="anchor" aria-label="anchor" href="#target-parameter"></a>
</h2>
<p>IsoXshift uses data-adaptive machine learning methods to identify the
exposures with the most synergy. This is defined based on our target
parameter:</p>
<p>$$</p>
<p><span class="math display">\[\begin{align}
  &amp;\Psi(A_i, A_j, W) = \underset{c_i, c_j}{\mathrm{argmin}}
  \left(\frac{|c_i - \mu_{A_i}| + |c_j - \mu_{A_j}|}{2}\right) \\
  &amp;\text{subject to the following constraints:} \nonumber \\
  &amp;\left|\mathbb{E}_{W, \textbf{A}_{-i,j}} [\mathbb{E} \left[Y \mid
A_i = c_i, A_j = c_j, \textbf{A}_{-i,j}, W \right]] -
Y_{\text{target}}\right| \leq \epsilon \\
  &amp;c_i \in \text{supp}(A_i), \ c_j \in \text{supp}(A_j) \nonumber
\end{align}\]</span></p>
<p>$$</p>
<p>This target findings the minimal shift that results in an expectation
that is the same (or close to) a target outcome. This finds the most
efficient intervention (most synergistic or antagonistic relationship)
that results in a target outcome.</p>
</div>
<div class="section level2">
<h2 id="g-computation-approximation">G-computation Approximation<a class="anchor" aria-label="anchor" href="#g-computation-approximation"></a>
</h2>
<p>To identify the most efficient exposure set which gets to the target
outcome we employ a g-computation framework. We first construct a super
learner, or ensemble of machine learning algorithms. We then construct
all two-way combinations and for each combination, on a grid between min
and max of the exposures, we get predictions through the model if the
exposures are set to the various levels. At each iteration we calculate
the mean difference between the new intervention level and the mean
natural exposure level. We collect all expectations that are close to
our target outcome and then select the ones with this lowest change from
the natural exposure levels. This gives us the exposure relationship and
levels of intervention, that result in the target outcome.</p>
</div>
<div class="section level2">
<h2 id="sample-splitting">Sample Splitting<a class="anchor" aria-label="anchor" href="#sample-splitting"></a>
</h2>
<p>Because we don’t know which exposure relationship and intervention to
estimate our synergy interaction parameter on a priori, we need to split
our data and in the training fold find the exposure sets, using the
above g-computation framework, and in an estimation sample, efficiently
estimate the interaction parameter for these exposure sets so that we
can get valid confidence intervals for these data-adaptively identified
interactions. This is done using targeted learning.</p>
</div>
<div class="section level2">
<h2 id="targeted-learning">Targeted Learning<a class="anchor" aria-label="anchor" href="#targeted-learning"></a>
</h2>
<p>We use targeted minimum loss based estimation (TMLE) to debias our
initial outcome estimates given a shift in exposure such that the
resulting estimator is asymptotically unbiased and has the smallest
variance. This procedure involves constructing a least favorable
submodel which uses a ratio of conditional exposure densities under
shift and now shift as a covariate to debias the initial estimates. More
details of targeted learning for stochastic shifts are here <span class="citation">Dı́az and van der Laan (2012)</span></p>
</div>
<div class="section level2">
<h2 id="data-adaptive-delta">Data Adaptive Delta<a class="anchor" aria-label="anchor" href="#data-adaptive-delta"></a>
</h2>
<p>Setting two exposures to specific levels, say PFAS 1 = 0.1, and PFAS
= 0.3, is not a pathwise differentiable parameter. Furthermore, it is
also not possible realistically to set all individual’s exposure levels
to one specific dose. We cannot, in the real world, for everyone to have
PFAS exposure of 0.1. What we can do is say that PFAS 1 = 0.1, and PFAS
= 0.3 has been found to most effectively reduce an outcome, like
diabetes, to levels that are deemed healthy. We want to simulate the
impact of an intention to intervene policy where we were to shift
people’s exposure levels towards this reduced amount, enforced by some
policy, but respecting that people will not get to that amount exactly.
People are restricted to how close they can get to this oracle level
based on their likelihood of exposure. In the package
<code>hn_trunc_thresh</code> indicates how far we can shift someone
towards the new policy levels before we do not have support in our data
to move them further, meaning their likelihood of the new intervention
level is too far their observed exposure likelihood. For example if
hn_trunc_thresh is set to 10, this means we are only willing a 10 fold
change to their natural likelihood. This restriction ensures we are not
creating estimates that are unfeasible in the real world.</p>
</div>
<div class="section level2">
<h2 id="inputs-and-outputs">Inputs and Outputs<a class="anchor" aria-label="anchor" href="#inputs-and-outputs"></a>
</h2>
<p>IsoXshift takes in covariates, exposures, an outcome,
target_outcome_lvl, which is the level of the outcome we want to reach,
epsilon, which is the amount of room around the target we allow for, the
estimator (tmle or one step) number of folds for the CV procedure, and
parallelization parameters.</p>
<p>The package then outputs K-fold specific results, the result found in
each fold, and the oracle result which is the parameter that is pooled
across all the folds. For example, we will get the fold specific synergy
results for exposure sets found to have the most synergy to our target
outcome. The pooled parameter is the pooling these estimates across the
folds.</p>
<p>If the same exposure sets are used across the folds, the pooled
estimate is interpretable and has greater power compared to k-fold. If
not, the analyst must investigate the k-fold specific results and report
consistency of findings.</p>
</div>
<div class="section level2">
<h2 id="nhanes-data">NHANES Data<a class="anchor" aria-label="anchor" href="#nhanes-data"></a>
</h2>
<p>Here we will try and replicate the analysis by Gibson et. al., <a href="https://ehjournal.biomedcentral.com/articles/10.1186/s12940-019-0515-1" class="external-link uri">https://ehjournal.biomedcentral.com/articles/10.1186/s12940-019-0515-1</a></p>
<p>and Mitro et. al, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4858394/" class="external-link uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4858394/</a></p>
<p>Who used the NHANES 2001-2002 data to investigate 18 POP exposures on
telomere length.</p>
<p>Because reduced telomere length is associated with more biological
aging and higher morbidity, we will try and identify which region in the
POP space would maximize telomere length. That is, we want to find the
region that, if we created a regulation on those chemicals, would result
in maximal change in elongating telomere length.</p>
<p>Let’s first load the data and investigate the variables:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"NHANES_eurocim"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exposures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LBX074LA"</span>, <span class="co"># PCB74 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX099LA"</span>, <span class="co"># PCB99 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX118LA"</span>, <span class="co"># PCB118 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX138LA"</span>, <span class="co"># PCB138 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX153LA"</span>, <span class="co"># PCB153 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX170LA"</span>, <span class="co"># PCB170 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX180LA"</span>, <span class="co"># PCB180 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX187LA"</span>, <span class="co"># PCB187 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX194LA"</span>, <span class="co"># PCB194 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBXD03LA"</span>, <span class="co"># 1,2,3,6,7,8-hxcdd Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXD05LA"</span>, <span class="co"># 1,2,3,4,6,7,8-hpcdd Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXD07LA"</span>, <span class="co"># 1,2,3,4,6,7,8,9-ocdd Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF03LA"</span>, <span class="co"># 2,3,4,7,8-pncdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF04LA"</span>, <span class="co"># 1,2,3,4,7,8-hxcdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF05LA"</span>, <span class="co"># 1,2,3,6,7,8-hxcdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF08LA"</span>, <span class="co"># 1,2,3,4,6,7,8-hxcdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXHXCLA"</span>, <span class="co"># 3,3',4,4',5,5'-hxcb Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXPCBLA"</span><span class="op">)</span> <span class="co"># 3,3',4,4',5-pcnb Lipid Adj (pg/g)</span></span>
<span></span>
<span><span class="va">NHANES_eurocim</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">exposures</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="st">"TELOMEAN"</span></span>
<span></span>
<span><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LBXWBCSI"</span>, <span class="co"># White blood cell count (SI)</span></span>
<span>                <span class="st">"LBXLYPCT"</span>, <span class="co"># Lymphocyte percent (%)</span></span>
<span>                <span class="st">"LBXMOPCT"</span>, <span class="co"># Monocyte percent (%)</span></span>
<span>                <span class="st">"LBXEOPCT"</span>, <span class="co"># Eosinophils percent (%)</span></span>
<span>                <span class="st">"LBXBAPCT"</span>, <span class="co"># Basophils percent (%)</span></span>
<span>                <span class="st">"LBXNEPCT"</span>, <span class="co"># Segmented neutrophils percent (%)</span></span>
<span>                <span class="st">"male"</span>, <span class="co"># Sex</span></span>
<span>                <span class="st">"age_cent"</span>, <span class="co"># Age at Screening, centered</span></span>
<span>                <span class="st">"race_cat"</span>, <span class="co"># race</span></span>
<span>                <span class="st">"bmi_cat3"</span>, <span class="co"># Body Mass Index (kg/m**2)</span></span>
<span>                <span class="st">"ln_lbxcot"</span>, <span class="co"># Cotinine (ng/mL), log-transformed</span></span>
<span>                <span class="st">"edu_cat"</span><span class="op">)</span> <span class="co"># Education Level - Adults 20+</span></span></code></pre></div>
<p>To improve consistency in the region we find to be the maximizing
region, it is best to remove an exposure of highly correlated sets, we
do that here:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the correlation matrix for the exposures</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">exposures</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set a threshold for high correlation</span></span>
<span><span class="va">threshold</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span></span>
<span><span class="co"># Find pairs of highly correlated exposures</span></span>
<span><span class="va">highly_correlated_pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">threshold</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initiate a vector to keep track of exposures to remove</span></span>
<span><span class="va">exposures_to_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop through the highly correlated pairs and decide which exposure to remove</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">pair</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">highly_correlated_pairs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">row</span> <span class="op">&lt;-</span> <span class="va">highly_correlated_pairs</span><span class="op">[</span><span class="va">pair</span>, <span class="st">"row"</span><span class="op">]</span></span>
<span>  <span class="va">col</span> <span class="op">&lt;-</span> <span class="va">highly_correlated_pairs</span><span class="op">[</span><span class="va">pair</span>, <span class="st">"col"</span><span class="op">]</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span><span class="op">[</span><span class="va">row</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">exposures_to_remove</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">exposures_to_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">exposures_to_remove</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span><span class="op">[</span><span class="va">row</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Keep only uncorrelated exposures</span></span>
<span><span class="va">exposures_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">exposures</span>, <span class="va">exposures_to_remove</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Assuming NHANES_eurocim is your dataframe:</span></span>
<span><span class="va">NHANES_eurocim_imputed</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">covariates</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-isoxshift">Run IsoXshift<a class="anchor" aria-label="anchor" href="#run-isoxshift"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ptm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim_imputed</span><span class="op">[</span>, <span class="va">covariates</span><span class="op">]</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim_imputed</span><span class="op">[</span>, <span class="va">exposures_to_keep</span><span class="op">]</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim_imputed</span><span class="op">$</span><span class="va">TELOMEAN</span></span>
<span></span>
<span><span class="va">n_folds</span> <span class="op">&lt;-</span> <span class="fl">5</span> </span>
<span></span>
<span><span class="va">NIEHS_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IsoXshift.html">IsoXshift</a></span><span class="op">(</span></span>
<span>  w <span class="op">=</span> <span class="va">w</span>,</span>
<span>  a <span class="op">=</span> <span class="va">a</span>,</span>
<span>  y <span class="op">=</span> <span class="va">y</span>,</span>
<span>  n_folds <span class="op">=</span> <span class="va">n_folds</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span>,</span>
<span>  target_outcome_lvl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.1</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2346.0944     Pars:  0.23223 0.76777</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2346.0944     Pars:  0.23222 0.76778</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2162.8790     Pars:  0.32310 0.67690</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2162.8790     Pars:  0.32310 0.67690</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1965.5602     Pars:  0.37407 0.62593</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1965.5602     Pars:  0.37407 0.62593</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2331.6303     Pars:  0.39103 0.60897</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2331.6303     Pars:  0.39103 0.60897</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1594.2412     Pars:  0.05653 0.94347</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1594.2412     Pars:  0.05653 0.94347</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1638.9745     Pars:  0.11549 0.88451</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1638.9745     Pars:  0.11549 0.88451</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2291.0797     Pars:  0.23010 0.76990</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2291.0797     Pars:  0.23011 0.76989</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1656.4558     Pars:  0.07710 0.92290</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1656.4558     Pars:  0.07710 0.92290</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1492.7099     Pars:  0.13074 0.86926</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1492.7099     Pars:  0.13075 0.86925</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2427.9789     Pars:  0.55752 0.44248</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2427.9789     Pars:  0.55752 0.44248</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1675.0042     Pars:  0.12499 0.87501</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1675.0042     Pars:  0.12499 0.87501</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1416.1243     Pars:  0.08566 0.91434</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1416.1243     Pars:  0.08566 0.91434</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2300.8859     Pars:  0.26234 0.73766</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2300.8859     Pars:  0.26234 0.73766</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2062.2603     Pars:  0.30580 0.69420</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2062.2603     Pars:  0.30580 0.69420</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1495.7234     Pars:  0.10211 0.89789</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1495.7234     Pars:  0.10211 0.89789</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">ptm</span></span>
<span><span class="co">#&gt;     user   system  elapsed </span></span>
<span><span class="co">#&gt;  261.315   89.374 3504.086</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="k-fold-results">K Fold Results<a class="anchor" aria-label="anchor" href="#k-fold-results"></a>
</h2>
<p>Let’s first look at the results for each fold:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k_fold_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">NIEHS_results</span><span class="op">$</span><span class="va">`K-fold Results`</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">k_fold_results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">k_fold_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"K Fold NHANES IsoXshift Results"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
K Fold NHANES IsoXshift Results
</caption>
<thead><tr>
<th style="text-align:right;">
Psi
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Fold
</th>
<th style="text-align:left;">
Average Delta
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0874155
</td>
<td style="text-align:right;">
0.0004108
</td>
<td style="text-align:right;">
0.0202670
</td>
<td style="text-align:right;">
0.0477
</td>
<td style="text-align:right;">
0.1271
</td>
<td style="text-align:right;">
0.5391919
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
-0.192
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0165047
</td>
<td style="text-align:right;">
0.0001388
</td>
<td style="text-align:right;">
0.0117822
</td>
<td style="text-align:right;">
-0.0066
</td>
<td style="text-align:right;">
0.0396
</td>
<td style="text-align:right;">
0.8791451
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
-0.651
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1535029
</td>
<td style="text-align:right;">
0.0007162
</td>
<td style="text-align:right;">
0.0267616
</td>
<td style="text-align:right;">
0.1011
</td>
<td style="text-align:right;">
0.2060
</td>
<td style="text-align:right;">
0.3480695
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
-0.192–0.651
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0495827
</td>
<td style="text-align:right;">
0.0002597
</td>
<td style="text-align:right;">
0.0161142
</td>
<td style="text-align:right;">
0.0180
</td>
<td style="text-align:right;">
0.0812
</td>
<td style="text-align:right;">
0.6960971
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
Interaction
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
-0.192–0.651
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0521076
</td>
<td style="text-align:right;">
0.0002009
</td>
<td style="text-align:right;">
0.0141743
</td>
<td style="text-align:right;">
0.0243
</td>
<td style="text-align:right;">
0.0799
</td>
<td style="text-align:right;">
0.6616236
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
-0.601
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0062616
</td>
<td style="text-align:right;">
0.0000824
</td>
<td style="text-align:right;">
0.0090776
</td>
<td style="text-align:right;">
-0.0241
</td>
<td style="text-align:right;">
0.0115
</td>
<td style="text-align:right;">
0.9476009
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
-1.023
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1251755
</td>
<td style="text-align:right;">
0.0005170
</td>
<td style="text-align:right;">
0.0227382
</td>
<td style="text-align:right;">
0.0806
</td>
<td style="text-align:right;">
0.1697
</td>
<td style="text-align:right;">
0.4064701
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
-0.601–1.023
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0793295
</td>
<td style="text-align:right;">
0.0002602
</td>
<td style="text-align:right;">
0.0161297
</td>
<td style="text-align:right;">
0.0477
</td>
<td style="text-align:right;">
0.1109
</td>
<td style="text-align:right;">
0.5322155
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:left;">
Interaction
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
-0.601–1.023
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0811892
</td>
<td style="text-align:right;">
0.0003488
</td>
<td style="text-align:right;">
0.0186773
</td>
<td style="text-align:right;">
0.0446
</td>
<td style="text-align:right;">
0.1178
</td>
<td style="text-align:right;">
0.5524618
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
-0.033
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0057671
</td>
<td style="text-align:right;">
0.0000478
</td>
<td style="text-align:right;">
0.0069150
</td>
<td style="text-align:right;">
-0.0193
</td>
<td style="text-align:right;">
0.0078
</td>
<td style="text-align:right;">
0.9447085
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
-0.841
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1219365
</td>
<td style="text-align:right;">
0.0004887
</td>
<td style="text-align:right;">
0.0221071
</td>
<td style="text-align:right;">
0.0786
</td>
<td style="text-align:right;">
0.1653
</td>
<td style="text-align:right;">
0.4121580
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
-0.033–0.841
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0465145
</td>
<td style="text-align:right;">
0.0002213
</td>
<td style="text-align:right;">
0.0148764
</td>
<td style="text-align:right;">
0.0174
</td>
<td style="text-align:right;">
0.0757
</td>
<td style="text-align:right;">
0.7029334
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
Interaction
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
-0.033–0.841
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0651092
</td>
<td style="text-align:right;">
0.0001823
</td>
<td style="text-align:right;">
0.0135030
</td>
<td style="text-align:right;">
-0.0916
</td>
<td style="text-align:right;">
-0.0386
</td>
<td style="text-align:right;">
0.5752694
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
-0.335
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0156215
</td>
<td style="text-align:right;">
0.0000966
</td>
<td style="text-align:right;">
0.0098293
</td>
<td style="text-align:right;">
-0.0349
</td>
<td style="text-align:right;">
0.0036
</td>
<td style="text-align:right;">
0.8747992
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
-0.476
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1150302
</td>
<td style="text-align:right;">
0.0002689
</td>
<td style="text-align:right;">
0.0163986
</td>
<td style="text-align:right;">
-0.1472
</td>
<td style="text-align:right;">
-0.0829
</td>
<td style="text-align:right;">
0.3690392
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
-0.335–0.476
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0342995
</td>
<td style="text-align:right;">
0.0002007
</td>
<td style="text-align:right;">
0.0141656
</td>
<td style="text-align:right;">
-0.0621
</td>
<td style="text-align:right;">
-0.0065
</td>
<td style="text-align:right;">
0.7732061
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
Interaction
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
-0.335–0.476
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0769076
</td>
<td style="text-align:right;">
0.0003950
</td>
<td style="text-align:right;">
0.0198742
</td>
<td style="text-align:right;">
0.0380
</td>
<td style="text-align:right;">
0.1159
</td>
<td style="text-align:right;">
0.5853843
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
0.113
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0264146
</td>
<td style="text-align:right;">
0.0002242
</td>
<td style="text-align:right;">
0.0149732
</td>
<td style="text-align:right;">
-0.0029
</td>
<td style="text-align:right;">
0.0558
</td>
<td style="text-align:right;">
0.8290913
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
-0.501
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0648823
</td>
<td style="text-align:right;">
0.0003801
</td>
<td style="text-align:right;">
0.0194965
</td>
<td style="text-align:right;">
0.0267
</td>
<td style="text-align:right;">
0.1031
</td>
<td style="text-align:right;">
0.6421654
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
0.113–0.501
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0384400
</td>
<td style="text-align:right;">
0.0002423
</td>
<td style="text-align:right;">
0.0155651
</td>
<td style="text-align:right;">
-0.0689
</td>
<td style="text-align:right;">
-0.0079
</td>
<td style="text-align:right;">
0.7579979
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:left;">
Interaction
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
0.113–0.501
</td>
</tr>
</tbody>
</table>
<p>Here, we find that the synergistic interaction between
LBXF03LA-LBXF04LA most efficiently gets to our target outcome of 10 %
longer telomere length. This means that these two exposure need to
changed the least together to get to our target outcome and therefore
represent the most efficient intervention policy.</p>
<p>We can look at what the target interventions are for each fold, this
represents our oracle point parameter or the exposure levels for these
two exposures that result in the 10% increase while being as close to
the observed distribution as possible.</p>
</div>
<div class="section level2">
<h2 id="oracle-intervention-levels">Oracle Intervention Levels<a class="anchor" aria-label="anchor" href="#oracle-intervention-levels"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">oracle_targets</span> <span class="op">&lt;-</span> <span class="va">NIEHS_results</span><span class="op">$</span><span class="va">`K Fold Oracle Targets`</span></span>
<span><span class="va">oracle_targets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">oracle_targets</span><span class="op">)</span></span>
<span><span class="va">oracle_targets</span><span class="op">$</span><span class="va">Fold</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_folds</span><span class="op">)</span></span>
<span></span>
<span><span class="va">oracle_targets</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Oracle Intervention Level Targets by Fold"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Oracle Intervention Level Targets by Fold
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Variable1
</th>
<th style="text-align:left;">
Variable2
</th>
<th style="text-align:right;">
ObservedLevel1
</th>
<th style="text-align:right;">
ObservedLevel2
</th>
<th style="text-align:right;">
IntervenedLevel1
</th>
<th style="text-align:right;">
IntervenedLevel2
</th>
<th style="text-align:right;">
AvgDiff
</th>
<th style="text-align:right;">
Difference
</th>
<th style="text-align:right;">
Fold
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
8205
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
6.634907
</td>
<td style="text-align:right;">
6.431677
</td>
<td style="text-align:right;">
6.636842
</td>
<td style="text-align:right;">
5.568421
</td>
<td style="text-align:right;">
0.4325956
</td>
<td style="text-align:right;">
0.1153347
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
7562
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
6.696894
</td>
<td style="text-align:right;">
6.448696
</td>
<td style="text-align:right;">
5.900000
</td>
<td style="text-align:right;">
5.657895
</td>
<td style="text-align:right;">
0.7938477
</td>
<td style="text-align:right;">
0.1135107
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
8521
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
6.769355
</td>
<td style="text-align:right;">
6.508685
</td>
<td style="text-align:right;">
6.636842
</td>
<td style="text-align:right;">
5.568421
</td>
<td style="text-align:right;">
0.5363883
</td>
<td style="text-align:right;">
0.1065145
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
7289
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
6.616129
</td>
<td style="text-align:right;">
6.339206
</td>
<td style="text-align:right;">
6.636842
</td>
<td style="text-align:right;">
6.778947
</td>
<td style="text-align:right;">
0.2302272
</td>
<td style="text-align:right;">
0.1038634
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
8367
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
6.800000
</td>
<td style="text-align:right;">
6.478784
</td>
<td style="text-align:right;">
6.636842
</td>
<td style="text-align:right;">
5.568421
</td>
<td style="text-align:right;">
0.5367605
</td>
<td style="text-align:right;">
0.1065158
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>Above, this table shows the most synergistic relationship
intervention targets per fold. Observed levels are the mean for the
training data for the respective exposure in the respective fold.
Intervened level is the level the exposure was set to in tandem with the
other exposure to meet the target outcome. Avg Diff is the average
difference between the intervened levels and natural exposure levels.
Difference is the deviation from the target outcome level and should be
within epsilon.</p>
</div>
<div class="section level2">
<h2 id="pooled-target-parameter">Pooled Target Parameter<a class="anchor" aria-label="anchor" href="#pooled-target-parameter"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">pooled_target_param</span> <span class="op">&lt;-</span> <span class="va">NIEHS_results</span><span class="op">$</span><span class="va">`Oracle Pooled Results`</span></span>
<span></span>
<span><span class="va">pooled_target_param</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Pooled Shift Towards Target"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Pooled Shift Towards Target
</caption>
<thead><tr>
<th style="text-align:right;">
Psi
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Fold
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.0173825
</td>
<td style="text-align:right;">
1.67e-05
</td>
<td style="text-align:right;">
0.0040873
</td>
<td style="text-align:right;">
-0.0254
</td>
<td style="text-align:right;">
-0.0094
</td>
<td style="text-align:right;">
0.7857073
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:left;">
Var 1
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0049934
</td>
<td style="text-align:right;">
1.74e-05
</td>
<td style="text-align:right;">
0.0041664
</td>
<td style="text-align:right;">
-0.0132
</td>
<td style="text-align:right;">
0.0032
</td>
<td style="text-align:right;">
0.9383373
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:left;">
Var 2
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0480909
</td>
<td style="text-align:right;">
2.37e-05
</td>
<td style="text-align:right;">
0.0048733
</td>
<td style="text-align:right;">
-0.0576
</td>
<td style="text-align:right;">
-0.0385
</td>
<td style="text-align:right;">
0.4908900
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:left;">
Joint
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0257150
</td>
<td style="text-align:right;">
2.86e-05
</td>
<td style="text-align:right;">
0.0053504
</td>
<td style="text-align:right;">
-0.0362
</td>
<td style="text-align:right;">
-0.0152
</td>
<td style="text-align:right;">
0.7251716
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:left;">
Interaction
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
</tr>
</tbody>
</table>
<p>These results show the pooled shift results across the folds. Going
back to our target interention levels, if we average the Intervened
Levels and Observed Levels, our average intervened level is 6.489474 for
LBXF03LA compared to observed 6.703457. For LBXF04LA the average
intervened level was 5.828421 compared to the average observed exposure
of 6.44141. This means we are trying to slightly reduce both exposures
in order to increase telomere length by 10%. We are trying to get the
population as close to these two exposure levels without violating
positivity, meaning here that the likelihood of the new exposure levels
is no more than 10 times different than the observed exposure likelihood
(this level is default in the IsoXshift run).</p>
<p>We can see that, although the results are consistent for the oracle
point parameter, estimation is a different story, we don’t see a
positive or significant result for our shifts, which indicates we can’t
move the population close enough to the oracle intervention level.</p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-diaz2012population" class="csl-entry">
Dı́az, Iván, and Mark J van der Laan. 2012. <span>“Population
Intervention Causal Effects Based on Stochastic Interventions.”</span>
<em>Biometrics</em> 68 (2): 541–49.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David McCoy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
